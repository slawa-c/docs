#SSH

# --- INSTALL ---

apt install -y openssh-server
systemctl status ssh
debian -->> sudo systemctl restart sshd

# --- CentOS ---
yum -y install openssh-server openssh-clients
## ---- CentOS 6.x and order
chkconfig sshd on
service sshd start # Start the service
netstat -tulpn | grep :22 # Make sure port 22 is opened
vim etc/sysconfig/iptables # Firewall Settings 
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
-A RH-Firewall-1-INPUT -s 192.168.1.0/24 -m state --state NEW -p tcp --dport 22 -j ACCEPT
-A RH-Firewall-1-INPUT -m tcp -p tcp --dport 22 -j ACCEPT
service iptables restart
## ---- CentOS 7.x and 8.x
systemctl enable sshd.service
systemctl start sshd.service
ss -tulpn | grep ':22' 
firewall-cmd --zone=public --add-service=ssh --permanent
firewall-cmd --reload


# --- gentoo ---
sudo /etc/init.d/sshd start




#ADD USER (SUDO)

$ adduser username
...
$ adduser username sudo
...

#CONFIGURE SSHD

$ vim /etc/ssh/sshd_config
  PermitRootLogin no
$ .... restart sshd


#--- GENERATION KEY ---

ssh-keygen -t ed25519 -C "your_email@example.com"

Note: If you are using a legacy system that doesn't support the Ed25519 algorithm, use:
$ ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
>>
Generating public/private rsa key pair.
>>
Enter file in which to save the key (/Users/your_user/.ssh/id_rsa): Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /Users/your_user/.ssh/id_rsa.
Your public key has been saved in /Users/your_user/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:XXXXXxxxxxXXXXXxxxxxXXXX... your_email@example.com
The key's randomart image is:
+---[RSA 4096]----+
|          .   . .|
|     .   . o .E+ |
|    o = o . o+  o|
|     * o . oo.=.o|
|      o S . .Bo+.|
|       + o  = B. |
|       .B  . B   |
|       =+.= +    |
|      .+=+ =.o   |
+----[SHA256]-----+


eval "$(ssh-agent -s)"
vim ~/.ssh/config
>>
Host *
  AddKeysToAgent yes
  UseKeychain yes
  IdentityFile ~/.ssh/id_rsa

ssh-add -K ~/.ssh/id_rsa


---------------
ssh-keygen -t rsa
ssh-keygen -t rsa username
ssh-keygen -b 4096 (4096-bit RSA, default 2048)
Generating public/private rsa key pair.
Enter file in which to save the key (/home/username/.ssh/id_rsa):

Enter passphrase (empty for no passphrase):

#COPY KEY REMOTE 
brew install ssh-copy-id
ssh-copy-id -i ~/.ssh/id_rsa.pub username@host


(id_rsa.pub --->>> authorized_keys remote host)

$ su - username
$ mkdir -p ~/.ssh or /home/username/.ssh and touch /home/username/.ssh/authorized_keys

$ ssh-copy-id username@remote_host
OR

$ cat ~/.ssh/id_rsa.pub | pbcopy
$ vim ~/.ssh/authorized_keys - >> copy
$ chmod -R go= ~/.ssh
$ 
$ sudo vim /etc/ssh/sshd_config
  PasswordAuthentication no
$ restart sshd
$ sudo visudo 
 %sudo ALL=(ALL:ALL) NOPASSWD:ALL
sudo apt install ufw
sudo apt-add-repository -y ppa:hda-me/nginx-stable
sudo apt-get install brotli nginx nginx-module-brotli
sudo systemctl unmask nginx.service --->>> Ubuntu 18
load_module modules/ngx_http_brotli_filter_module.so; load_module modules/ngx_http_brotli_static_module.so;
